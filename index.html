<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Covid-19 Open Restaurants Dashboard</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/>
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css"/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>
</head>
<body>
  <!-- sidebar -->
  <div id="info">

    <div id="title">Operating During Covid-19</div>
    <div id="placename">Name</div>
    <div id="details" class="card">
      <h5 id="phone">Phone:</h5>
      <h5 id="website">Website:</h5>
      <h5 id="address">Address:</h5>
      <p id="availability">Open for:</p>
      <p id="notes"></p>
    </div>
    <p id="date"></p>
  </div>
  <!-- mainwindow -->
  <div id="map">
  <script>
  var mymap = L.map('map', {
    center: [47.65, -122.31],
    zoom: 15,
    maxZoom: 20,
    minZoom: 12,
    zoomControl: false,
    detectRetina: true
  });

  new L.Control.Zoom({
    position: 'topright'
  }).addTo(mymap);


  var Stadia_OSMBright = L.tileLayer('https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png', {
	maxZoom: 20,
	attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
  });
  Stadia_OSMBright.addTo(mymap);
var countiesLayer = null,
  bchart = null,
  counties = {};

  Promise.all([$.getJSON("https://opendata.arcgis.com/datasets/32d35b66d9a54db7a7f489d34a86f603_0.geojson")]).then(function(datasets) {

    countiesLayer = L.geoJSON(datasets[0], {
      onEachFeature: onEachFeature
    }).addTo(mymap);

  });
  function onEachFeature(feature, layer) {
    layer.on({
      click: clickFeature,
    });
  }

  function clickFeature(e) {
    L.DomEvent.stopPropagation(e);
    console.log(e.target.feature.properties);
    console.log(e.target.feature.properties.provide_details_for_you_busines);
    $("#placename").text(e.target.feature.properties.business_name);
    var website = e.target.feature.properties.business_website;
    if (website == null) {
      $("#website").text("Website: Not available");
    } else {
      $("#website").text("Website: " + website);
    }
    var phone = e.target.feature.properties.phone_number_to_place_an_order;
    if (phone == null) {
      $("#phone").text("Phone: Not available");
    }
    $("#phone").text("Phone: " + phone);
    $("#address").text("Address: " + e.target.feature.properties.address_help_your_customer_find);
    $("#availability").text("Open for: " + e.target.feature.properties.are_you_open_for.replace(/_/g, ' '));
    var notes = e.target.feature.properties.provide_details_for_you_busines;
    if (notes == null) {
      $("notes").text();
    } else {
      $("#notes").text("Notes: " + notes);
    }
  }

  </script>
  </div>
</body>
</html>
